.theme-switch-wrapper {
  display: inline-flex;
}

.theme-switch-track {
  position: relative;
  display: flex;
  width: 116px;
  height: 40px;
  border-radius: 99px;
  background: rgba(var(--window-fg-color-rgb), 0.08);
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
  transition: background 0.3s ease;

  .click-areas {
    position: absolute;
    inset: 0;
    display: flex;
    z-index: 2;

    button {
      flex: 1;
      background: transparent;
      border: none;
      padding: 0;
      margin: 0;
      cursor: pointer;
      border-radius: 99px;
      outline: none;
      -webkit-tap-highlight-color: transparent;

      &:focus-visible {
        background: rgba(var(--window-fg-color-rgb), 0.05);
      }
    }
  }

  .track-placeholders {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    padding: 0 4px;
    gap: 6px;
    z-index: 0;
    pointer-events: none;

    .placeholder {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--dim-color);
      opacity: 0.4;

      svg {
        width: 16px;
        height: 16px;
      }
    }
  }
}

// The sliding thumb
.theme-thumb {
  position: absolute;
  top: 4px;
  left: 4px;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: var(--view-bg-color);
  box-shadow: var(--shadow-popover, 0 2px 6px rgba(0, 0, 0, 0.15));
  z-index: 1;
  display: flex;
  align-items: center;
  justify-content: center;

  transition:
    transform 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    color 0.5s ease;

  .theme-svg {
    width: 20px;
    height: 20px;
  }
}

// Shared SVG transition properties
.mask-half,
.mask-crescent,
.core,
.system-outline,
.sun-rays,
.moon-star,
.moon-star-2 {
  transition:
    transform 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    opacity 0.5s ease;
  transform-origin: 12px 12px;
}

.moon-star {
  transform-origin: 16px 4px;
}
.moon-star-2 {
  transform-origin: 21.5px 9px;
}

// ============================================================================
// STATE 1: LIGHT MODE
// ============================================================================
.theme-switch-track.light {
  .theme-thumb {
    transform: translateX(0);
    color: var(--gnome-orange-3);
  }

  .mask-half {
    transform: translateX(12px);
  }
  .mask-crescent {
    transform: translate(12px, -12px);
  }
  .core {
    transform: scale(0.85);
  }
  .system-outline {
    opacity: 0;
    transform: scale(0.8);
  }
  .sun-rays {
    opacity: 1;
    transform: rotate(0) scale(1);
  }
  .moon-star,
  .moon-star-2 {
    opacity: 0;
    transform: scale(0) rotate(-45deg);
  }
}

// ============================================================================
// STATE 2: SYSTEM (AUTO) MODE
// ============================================================================
.theme-switch-track.system {
  .theme-thumb {
    transform: translateX(38px);
    color: var(--dim-color);
  }

  .mask-half {
    transform: translateX(0);
  }
  .mask-crescent {
    transform: translate(12px, -12px);
  }
  .core {
    transform: scale(1);
  }
  .system-outline {
    opacity: 1;
    transform: scale(1);
  }
  .sun-rays {
    opacity: 0;
    transform: rotate(45deg) scale(0.2);
  }
  .moon-star,
  .moon-star-2 {
    opacity: 0;
    transform: scale(0) rotate(-45deg);
  }
}

// ============================================================================
// STATE 3: DARK MODE
// ============================================================================
.theme-switch-track.dark {
  .theme-thumb {
    transform: translateX(76px);
    color: var(--gnome-blue-2);
  }

  .mask-half {
    transform: translateX(12px);
  }
  .mask-crescent {
    transform: translate(0, 0);
  }
  .core {
    transform: scale(1.15);
  }
  .system-outline {
    opacity: 0;
    transform: scale(1.2);
  }
  .sun-rays {
    opacity: 0;
    transform: rotate(90deg) scale(0);
  }
  .moon-star {
    opacity: 1;
    transform: scale(1) rotate(0);
  }
  .moon-star-2 {
    opacity: 1;
    transform: scale(1) rotate(0);
    transition-delay: 0.1s; // Slight pop delay for the second tiny star
  }
}
